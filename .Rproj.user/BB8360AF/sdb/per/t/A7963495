{
    "collab_server" : "",
    "contents" : "## Reginald Edwards\n## CREATED: 1 March 2018\n## MODIFIED:\n## DESCRIPTION: Add modeling features\n###############################################################################\n\nrm(list=ls())\n\n###############################################################################\n## Add features to training dataset\n###############################################################################\n## load training data\nload('data/working/results.RData')\n\n## Add team seeds and upset indicator variable\n## merge team seeds\nload('data/working/seeds.RData')\nX.res <- merge(X.res, X.seeds, by.x = c('wteamid', 'season'), \n               by.y = c('teamid', 'season'))\nX.res$wseed <- X.res$seed\nX.res$wnseed <- X.res$nseed\nX.res$seed <- NULL\nX.res$nseed <- NULL\n\nX.res <- merge(X.res, X.seeds, by.x = c('lteamid', 'season'), \n               by.y = c('teamid', 'season'))\nX.res$lseed <- X.res$seed\nX.res$lnseed <- X.res$nseed\nX.res$seed <- NULL\nX.res$nseed <- NULL\n\no <- order(X.res$season, X.res$wteamid)\nX.res <- X.res[o, ]\nX.res$upset <- ifelse(X.res$wnseed > X.res$lnseed, 1, 0)\n\n\n## Limit training dataset to [1985-2013]\no <- which(X.res$season <= 2013)\nX.train <- X.res[o, ]\n\n# compute y\nf <- function(x, i) unlist(strsplit(x, \"_\"))[i]\nX.train$team1 <- unlist(lapply(X.train$id, f, i = 2))\nX.train$team2 <- unlist(lapply(X.train$id, f, i = 3))\nX.train$y <- ifelse(X.train$team1 == X.train$wteamid, 1, 0)\nX.train$y <- ifelse(X.train$team1 == X.train$wteamid, 1, 0)\n\n## Add team seeds and upset indicator variable\n## merge team seeds\nload('data/working/seeds.RData')\nX.train <- merge(X.train, X.seeds, by.x = c('team1', 'season'), \n                 by.y = c('teamid', 'season'))\nX.train$seed1 <- X.train$seed\nX.train$nseed1 <- X.train$nseed\nX.train$seed <- NULL\nX.train$nseed <- NULL\n\nX.train <- merge(X.train, X.seeds, by.x = c('team2', 'season'), \n                 by.y = c('teamid', 'season'))\nX.train$seed2 <- X.train$seed\nX.train$nseed2 <- X.train$nseed\nX.train$seed <- NULL\nX.train$nseed <- NULL\n\nX.train$seed1.lower <- ifelse(X.train$nseed1 < X.train$nseed2, 1, 0)\n\nsave(X.train, file = 'data/working/training.RData')\n\n###############################################################################\n## Add features to testing dataset\n###############################################################################\n## load test data\nload('data/working/testing.RData')\n\n## Add team seeds and upset indicator variable\n## merge team seeds\nload('data/working/seeds.RData')\nX.test <- merge(X.test, X.seeds, by.x = c('team1', 'season'), \n                by.y = c('teamid', 'season'))\nX.test$seed1 <- X.test$seed\nX.test$nseed1 <- X.test$nseed\nX.test$seed <- NULL\nX.test$nseed <- NULL\n\nX.test <- merge(X.test, X.seeds, by.x = c('team2', 'season'), \n                by.y = c('teamid', 'season'))\nX.test$seed2 <- X.test$seed\nX.test$nseed2 <- X.test$nseed\nX.test$seed <- NULL\nX.test$nseed <- NULL\n\nX.test$seed1.lower <- ifelse(X.test$nseed1 < X.test$nseed2, 1, 0)\n\no <- order(X.test$id)\nX.test <- X.test[o, ]\nsave(X.test, file = 'data/working/testing.RData')\n\n## Regular season win-loss record\nsource('code/reg-season-win-probability.R')",
    "created" : 1519926647864.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1665367369",
    "id" : "A7963495",
    "lastKnownWriteTime" : 1519939463,
    "last_content_update" : 1519939463299,
    "path" : "C:/Users/Reginald/Dropbox/Kaggle - NCAA ML 2018/code/add-features.R",
    "project_path" : "code/add-features.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}